<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vertical electrical sounding &mdash; Advanced Geophysics 2023 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Introduction" href="Introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Advanced Geophysics 2023
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">GPR Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../GPR/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GPR/SettingUpPython.html">Python Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GPR/DataCollection.html">Data Collection and Import</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GPR/OverviewMap.html">Getting an Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GPR/GPRProcessing.html">GPR Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GPR/Interpretation3D.html">3D Interpretation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Inversion of simple models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Inversion/Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Inversion/LinearCase.html">Linear Least Squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Inversion/NonLinearCase.html">Non-linear least squares</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resistivity Mapping</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vertical electrical sounding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#inversion-with-a-twin-experiment">Inversion with a Twin Experiment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inversion-including-regularization">Inversion including regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inversion-including-bootstrapping">Inversion including bootstrapping</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Advanced Geophysics 2023</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Vertical electrical sounding</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ResistivityMapping/VESIntro.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vertical-electrical-sounding">
<h1>Vertical electrical sounding<a class="headerlink" href="#vertical-electrical-sounding" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>In a vertical electrical sounding survey, this assumption is that the resistivity varies only in the vertical. This is an appropriate assumption, e.g., for floodplains and allows for a much quicker survey compared to a full tomography setup which would also map change in the lateral direction. The solution of the Laplace/Poisson equations underlying the resistivity method are in large parts analytical and can be coded (comparatively) easily without using more advanced methods such as finite differences etc.. Please refer to Binley &amp; Slater section 4.2.1.3 for more details. The input parameters for this model are the survey geometry (here: Schlumberger setup where the distance between the current electrodes A and B is progressively increased ) and the assumed subsurface model. The latter is for example described as multiple blocks with a given thickness and resistivity.</p>
<a class="reference internal image-reference" href="../_images/ModelDemonstration.png"><img alt="Demonstration of the VES Forward Model" src="../_images/ModelDemonstration.png" style="width: 700px;" /></a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="c1"># Forward Model for VES</span>
<span class="k">def</span> <span class="nf">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">):</span>
    <span class="n">ParameterLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ParameterLength</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>                   <span class="c1"># resistivities</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span><span class="n">ParameterLength</span><span class="p">]</span>     <span class="c1"># thickness</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">VectorABHalf</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="mi">13</span>
            <span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mf">4.438</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">li</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">h</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">li</span><span class="p">):</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">l</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">while</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">T</span><span class="o">*</span><span class="n">aa</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
                <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">e</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="mi">105</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">262</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">416</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">746</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="mi">1605</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">-</span><span class="mi">4390</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="mi">13396</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">11</span><span class="p">]</span><span class="o">-</span><span class="mi">27841</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">13</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">+</span><span class="mi">16448</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]</span><span class="o">+</span><span class="mi">8183</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">17</span><span class="p">]</span><span class="o">+</span><span class="mi">2525</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">19</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho_a</span><span class="o">+</span><span class="mi">336</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span><span class="o">+</span><span class="mi">225</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">23</span><span class="p">])</span><span class="o">/</span><span class="mi">10000</span><span class="p">;</span>
            <span class="n">rho_semu</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_a</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Params must be odd number (first resistivities, then layer thickness.&#39;</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">rho_semu</span>

<span class="c1"># set parameters of the subsurface model</span>
<span class="n">Params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>    <span class="c1"># first resistivities, then thicknesses</span>
<span class="n">VectorABHalf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="c1"># forward model uses Schlummberger Array</span>
<span class="c1"># create synthetic observations for a given subsurface model</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">)</span>


<span class="c1"># Visualize the results</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">NL</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Params</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Params</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Params</span><span class="p">[</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">::])),</span><span class="s1">&#39;b-x&#39;</span><span class="p">,</span><span class="n">drawstyle</span> <span class="o">=</span> <span class="s1">&#39;steps&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;subsurface model&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Resistivities (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;model predictions&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;AB/2 (m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Apparent Resistivity (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<section id="inversion-with-a-twin-experiment">
<h2>Inversion with a Twin Experiment<a class="headerlink" href="#inversion-with-a-twin-experiment" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>The idea of a Twin experiment is to test the workflow of the inversion by creating synthetic observations with some additional noise for a given subsurface model. The inversion can then be tested as it should ideally reconstruct the subsurface model from the observations. If it doesn‚Äôt this kind of experiment can give interesting insights for trade-offs between different model parameters. In a VES surveys, such trade-offs between resistivities and layer thickness may occur. Because the forward model is clearly non-linear, we will use a in-built optimizer in order to find the minimum of the associated cost function. This optimizer will use a variant of the previously discussed Gauss-Newton method and unsurprinsingly does require a starting model. Here are the results and the workflow of a Twin experiment for a VES survey. It clearly highlighs that multiple sub-surface models will explain the data almost equally well.</p>
<a class="reference internal image-reference" href="../_images/SyntheticTwinExperiment.png"><img alt="Demonstration of Twin Experiment" src="../_images/SyntheticTwinExperiment.png" style="width: 700px;" /></a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sy</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>

<span class="c1"># Forward Model and model data misfit</span>
<span class="k">def</span> <span class="nf">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">):</span>


    <span class="n">ParameterLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ParameterLength</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>                   <span class="c1"># resistivities</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span><span class="n">ParameterLength</span><span class="p">]</span>     <span class="c1"># depth</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">VectorABHalf</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="mi">13</span>
            <span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mf">4.438</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">li</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">h</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">li</span><span class="p">):</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">l</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">while</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">T</span><span class="o">*</span><span class="n">aa</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
                <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">e</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="mi">105</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">262</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">416</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">746</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="mi">1605</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">-</span><span class="mi">4390</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="mi">13396</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">11</span><span class="p">]</span><span class="o">-</span><span class="mi">27841</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">13</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">+</span><span class="mi">16448</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]</span><span class="o">+</span><span class="mi">8183</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">17</span><span class="p">]</span><span class="o">+</span><span class="mi">2525</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">19</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho_a</span><span class="o">+</span><span class="mi">336</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span><span class="o">+</span><span class="mi">225</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">23</span><span class="p">])</span><span class="o">/</span><span class="mi">10000</span><span class="p">;</span>
            <span class="n">rho_semu</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_a</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Params must be odd number (first resistivities, then layer thickness.&#39;</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">rho_semu</span>

<span class="k">def</span> <span class="nf">CostFunction</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="n">rho_semu</span> <span class="o">=</span>  <span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">)</span>
    <span class="n">LF</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">rho_semu</span><span class="o">-</span><span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">LF</span>



<span class="c1"># set variables</span>
<span class="n">Params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">30</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>    <span class="c1"># first resistivities, then thicknesses</span>
<span class="n">VectorABHalf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>              <span class="c1"># forward model uses Schlummberger Array</span>
<span class="c1"># creat synthetic true data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">)</span>
<span class="c1"># add noise</span>
<span class="n">random</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">data_noise</span> <span class="o">=</span> <span class="n">data</span><span class="o">+</span><span class="n">random</span>
<span class="c1"># first guess</span>
<span class="n">Params_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">190</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">data_guess</span> <span class="o">=</span> <span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span> <span class="n">VectorABHalf</span><span class="p">)</span>

<span class="c1">#this is the inversion, use lest maxiter if you want it faster but less well converged</span>
<span class="n">LF_min</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">CostFunction</span><span class="p">,</span><span class="n">Params_guess</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data_noise</span><span class="p">),</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;trust-constr&#39;</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3000</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)),</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;This is the optimized result </span><span class="si">{</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;This is the relative error </span><span class="si">{</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">Params</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># plot data + inversion results</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">NL</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Params</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Params</span><span class="p">[</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">::])),</span><span class="s1">&#39;b-x&#39;</span><span class="p">,</span><span class="n">drawstyle</span> <span class="o">=</span> <span class="s1">&#39;steps&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">NL</span><span class="o">+</span><span class="mi">1</span><span class="p">::])),</span><span class="s1">&#39;g-x&#39;</span><span class="p">,</span><span class="n">drawstyle</span> <span class="o">=</span> <span class="s1">&#39;steps&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Resistivities (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;truth&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data_noise</span><span class="p">,</span><span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data with noise&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params_guess</span><span class="p">,</span> <span class="n">VectorABHalf</span><span class="p">),</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;initial Guess&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">VESForward_RD</span><span class="p">(</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">VectorABHalf</span><span class="p">),</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;optimized result&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;AB/2 (m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Apparent Resistivity (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="inversion-including-regularization">
<h2>Inversion including regularization<a class="headerlink" href="#inversion-including-regularization" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>In the previous example, the number of layers is a hyper-parameter that needs to be chosen ahead of time and requires some expert knowledge about the specific survey area. We can change this by assuming many equidistant layers which only vary in their resistivity. Depending on the vertical resolution and maximum sounding depth, this can result in many model parameters which are arguably more difficult to invert than in the previous case. However, we can use regularization and prescibe a smoothness constrained so that the resistivities do not vary too strongly with depth. This is a nice example of including additional knowledge in form of regularization. Here is the workflow.</p>
<a class="reference internal image-reference" href="../_images/RegularizedConstrainedInversion.png"><img alt="Demonstration of Twin Experiment" src="../_images/RegularizedConstrainedInversion.png" style="width: 700px;" /></a>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sy</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">opt</span>

<span class="c1"># Forward Model and model data misfit</span>
<span class="k">def</span> <span class="nf">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">):</span>
    <span class="n">ParameterLength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Params</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ParameterLength</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>                   <span class="c1"># resistivities</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Params</span><span class="p">[</span><span class="nb">int</span><span class="p">((</span><span class="n">ParameterLength</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span><span class="n">ParameterLength</span><span class="p">]</span>     <span class="c1"># thickness</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">VectorABHalf</span>

        <span class="n">ls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ls</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="mi">13</span>
            <span class="n">f</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="n">m</span> <span class="o">=</span> <span class="mf">4.438</span>
            <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">))</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">/</span><span class="n">m</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
            <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="n">li</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">h</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">li</span><span class="p">):</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">l</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">while</span> <span class="n">w</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">-</span><span class="mi">1</span>
                    <span class="n">aa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">+</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">T</span><span class="o">*</span><span class="n">aa</span><span class="o">/</span><span class="n">r</span><span class="p">[</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span>
                <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">e</span>

            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="mi">105</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">262</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">416</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="mi">746</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="mi">1605</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">-</span><span class="mi">4390</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">]</span><span class="o">+</span><span class="mi">13396</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">11</span><span class="p">]</span><span class="o">-</span><span class="mi">27841</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">13</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="n">rho_a</span><span class="o">+</span><span class="mi">16448</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">15</span><span class="p">]</span><span class="o">+</span><span class="mi">8183</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">17</span><span class="p">]</span><span class="o">+</span><span class="mi">2525</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">19</span><span class="p">]</span>
            <span class="n">rho_a</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho_a</span><span class="o">+</span><span class="mi">336</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span><span class="o">+</span><span class="mi">225</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">23</span><span class="p">])</span><span class="o">/</span><span class="mi">10000</span><span class="p">;</span>
            <span class="n">rho_semu</span><span class="p">[</span><span class="n">ii</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho_a</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Params must be odd number (first resistivities, then layer thickness.&#39;</span><span class="p">)</span>
        <span class="n">rho_semu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">rho_semu</span>


<span class="k">def</span> <span class="nf">CostFunction</span><span class="p">(</span><span class="n">Resistivities</span><span class="p">,</span><span class="n">Thickness</span><span class="p">,</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">Data</span><span class="p">,</span><span class="n">DD</span><span class="p">,</span><span class="n">LagrangeMult</span><span class="p">):</span>
    <span class="n">rho_semu</span><span class="o">=</span><span class="n">VESForward_RD</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Resistivities</span><span class="p">,</span><span class="n">Thickness</span><span class="p">),</span><span class="n">VectorABHalf</span><span class="p">)</span>
    <span class="n">LF</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">rho_semu</span><span class="o">-</span><span class="n">Data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="o">+</span> <span class="n">LagrangeMult</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">DD</span><span class="p">,</span><span class="n">Resistivities</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">LF</span>

<span class="c1"># Here we now change to a constant depth spacing. For each spacing one resistivity.</span>
<span class="c1"># The smaller the dz, the longer the inversion will take.</span>
<span class="n">dz</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span><span class="n">maxz</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span><span class="n">z</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">maxz</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">maxz</span><span class="o">/</span><span class="n">dz</span><span class="p">));</span><span class="n">Np</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
<span class="n">rhos</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">+</span> <span class="mi">400</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">+</span> <span class="mi">125</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">-</span> <span class="mi">21</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.3</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">z</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)))</span>

<span class="c1"># Get the smoothness constraint Matrix</span>
<span class="n">DD</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dz</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># Flatness at boundaries</span>
<span class="n">DD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">dz</span>
<span class="n">DD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dz</span>
<span class="n">DD</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">DD</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">dz</span>
<span class="n">DD</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">dz</span>

<span class="c1">#Initial Guess assumed to be constant</span>
<span class="n">b_0</span> <span class="o">=</span> <span class="n">rhos</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="mi">300</span><span class="p">;</span>
<span class="c1">#Resistivities first, thickness second. The latter are now constant.</span>
<span class="n">Params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">rhos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)])</span>
<span class="n">Params_guess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">b_0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)])</span>

<span class="c1"># Setup your Observations, best would be on a different grid but we don&#39;t do this for now.</span>
<span class="c1"># If we have only few observations regularization is more important</span>
<span class="n">No</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">VectorABHalf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">No</span><span class="p">)</span>
<span class="n">data_truth</span> <span class="o">=</span> <span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params</span><span class="p">,</span> <span class="n">VectorABHalf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Np: </span><span class="si">{</span><span class="n">Np</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No: </span><span class="si">{</span><span class="n">No</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Prepare the twin experiment adding noise</span>
<span class="n">random</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">No</span><span class="p">)</span>
<span class="n">data_noise</span> <span class="o">=</span> <span class="n">data_truth</span><span class="o">+</span><span class="n">random</span>

<span class="c1">#Choose Lagrange Multiplier (the larger the smoother)</span>
<span class="n">LagrangeMult</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="n">bnds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rhos</span><span class="p">]</span>
<span class="c1">#Start the inversion. Reduce Maxiter if it should go faster with less convergence.</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Starting the Inversion with smoothness constrained&#39;</span><span class="p">)</span>
<span class="c1">#LF_min = opt.minimize(VESForward_RD_ss_reg,b_0, args=(np.diff(z),VectorABHalf,data_noise,DD,LagrangeMult),method=&#39;trust-constr&#39;,options={&#39;maxiter&#39;: 20, &#39;disp&#39;: True})</span>
<span class="n">LF_min</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">CostFunction</span><span class="p">,</span><span class="n">b_0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data_noise</span><span class="p">,</span><span class="n">DD</span><span class="p">,</span><span class="n">LagrangeMult</span><span class="p">),</span><span class="n">bounds</span><span class="o">=</span><span class="n">bnds</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;trust-constr&#39;</span><span class="p">,</span><span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span><span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;disp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;This is the optimized result </span><span class="si">{</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;This is the relative error </span><span class="si">{</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">rhos</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhos</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;truth&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;inverted&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Resistivites (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data_truth</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;truth&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">data_noise</span><span class="p">,</span><span class="s1">&#39;rx&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data with noise&#39;</span><span class="p">)</span>
<span class="c1">#Initial Guess</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">VESForward_RD</span><span class="p">(</span><span class="n">Params_guess</span><span class="p">,</span> <span class="n">VectorABHalf</span><span class="p">),</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;initial Guess&#39;</span><span class="p">)</span>
<span class="c1">#Predictions from Inversion</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">VectorABHalf</span><span class="p">,</span><span class="n">VESForward_RD</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LF_min</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">z</span><span class="p">)),</span> <span class="n">VectorABHalf</span><span class="p">),</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;optimized result&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;AB/2 (m)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Apparent resistivity (Ohm m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="inversion-including-bootstrapping">
<h2>Inversion including bootstrapping<a class="headerlink" href="#inversion-including-bootstrapping" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>We have not covered the theory in WS2023, but I put it here for those who are interested in quantifying errors of the inversion. In the inversion of the block model VES we noticed that a number of trade-offs occur between resistivities and layer thickness. bootstrapping is one way to quantify it and I have outline the theory here:</p>
<a class="reference external image-reference" href="https://www.youtube.com/watch?v=rvz9wvxvge4"><img alt="An example for bootstrapping" src="../_images/VideoBootstrapping.png" style="width: 700px;" /></a>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, R. Drews.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>